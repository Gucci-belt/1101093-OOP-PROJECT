<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="mobile-screen">
        
        <header class="header">
            <span class="header-title">‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</span>
            <a href="profile.html" class="profile-icon"></a>
        </header>
        
        <div class="content">
            <h2 class="page-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>

            <div class="form-group">
                <label for="edit-weight">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (kg)</label>
                <input type="text" id="edit-weight">
            </div>
            
            <div class="form-group">
                <label for="edit-height">‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (cm)</label>
                <input type="text" id="edit-height">
            </div>

            <button id="recalcBtn" class="btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà</button>
            
            <div class="bmi-result-box" id="profile-bmi-box">
                <strong>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å:</strong> <span id="profile-weight">--</span> kg
                <br>
                <strong>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á:</strong> <span id="profile-height">--</span> cm
                <br><br>
                <strong>‡∏Ñ‡πà‡∏≤ BMI:</strong> <span id="profile-bmi">--.-</span>
                <br>
                <small>(‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô <span id="profile-calories">----</span> ‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà)</small>
            </div>
            
            <table class="bmi-table">
                <thead>
                    <tr>
                        <th>‡∏Ñ‡πà‡∏≤‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á</th>
                        <th>‡∏Ñ‡πà‡∏≤ BMI</th>
                    </tr>
                </thead>
                <tbody id="bmi-table-body">
                    <tr>
                        <td>...</td>
                        <td>...</td>
                    </tr>
                </tbody>
            </table>

            <a href="login.html" class="btn btn-secondary-link" style="margin-top: 20px;" id="logoutBtn">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
        </div>
        <footer class="footer-nav">
            <a href="home.html" class="footer-icon">‚¨ÖÔ∏è</a>
            <a href="cart.html" class="footer-icon">üõí</a>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 1. ‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            const username = localStorage.getItem('currentUser');
            if (!username) {
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà login ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ login
                window.location.href = 'login.html';
                return;
            }

            // 2. ‡∏î‡∏∂‡∏á Element ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ
            const editWeight = document.getElementById('edit-weight');
            const editHeight = document.getElementById('edit-height');
            const recalcBtn = document.getElementById('recalcBtn');
            const profileWeight = document.getElementById('profile-weight');
            const profileHeight = document.getElementById('profile-height');
            const profileBmi = document.getElementById('profile-bmi');
            const profileCalories = document.getElementById('profile-calories');
            const bmiTableBody = document.getElementById('bmi-table-body');
            const logoutBtn = document.getElementById('logoutBtn');

            // 3. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
            loadProfileData();

            // 4. ‡∏ú‡∏π‡∏Å Event ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà
            recalcBtn.addEventListener('click', function() {
                const newWeight = parseFloat(editWeight.value);
                const newHeight = parseFloat(editHeight.value);

                if (newWeight > 0 && newHeight > 0) {
                    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì BMI
                    fetch('http://localhost:8080/api/bmi/calculate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            username: username,
                            weight: newWeight,
                            height: newHeight
                        })
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.status === 'success') {
                            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            updateProfileDisplay({
                                weight: newWeight,
                                height: newHeight,
                                bmi: data.bmi,
                                calories: data.calories,
                                category: data.category,
                                categoryRange: data.categoryRange
                            });
                            
                            // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                            setTimeout(() => {
                                loadProfileData();
                            }, 100);
                            
                            alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß!');
                            // Update streak
                            localStorage.setItem(`lastUpdate_${username}`, new Date().toISOString());
                        } else {
                            alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + (data.message || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ'));
                        }
                    })
                    .catch(error => {
                        console.error('Error calculating BMI:', error);
                        let errorMessage = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö server ‡πÑ‡∏î‡πâ';
                        if (error.message) {
                            errorMessage = error.message;
                        }
                        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + errorMessage + '\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Backend Server ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà http://localhost:8080');
                        
                        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÅ‡∏ö‡∏ö‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ù‡∏±‡πà‡∏á client
                        const calculatedBmi = (newWeight / ((newHeight / 100) ** 2)).toFixed(1);
                        const calories = Math.round(newWeight * 24);
                        let category = '';
                        let categoryRange = '';
                        
                        if (calculatedBmi < 18.5) {
                            category = '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ô‡πâ‡∏≠‡∏¢';
                            categoryRange = '‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 18.5';
                        } else if (calculatedBmi < 23.0) {
                            category = '‡∏õ‡∏Å‡∏ï‡∏¥';
                            categoryRange = '18.5 - 22.9';
                        } else if (calculatedBmi < 25.0) {
                            category = '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô';
                            categoryRange = '23.0 - 24.9';
                        } else if (calculatedBmi < 30.0) {
                            category = '‡∏≠‡πâ‡∏ß‡∏ô';
                            categoryRange = '25.0 - 29.9';
                        } else {
                            category = '‡∏≠‡πâ‡∏ß‡∏ô‡∏°‡∏≤‡∏Å';
                            categoryRange = '30.0 ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ';
                        }
                        
                        updateProfileDisplay({
                            weight: newWeight,
                            height: newHeight,
                            bmi: calculatedBmi,
                            calories: calories,
                            category: category,
                            categoryRange: categoryRange
                        });
                    });
                } else {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                }
            });

            // 5. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á
            function loadUserData() {
                fetch(`http://localhost:8080/api/bmi/data/${username}`)
                    .then(response => {
                        if (!response.ok) {
                            // ‡∏ñ‡πâ‡∏≤ response ‡πÑ‡∏°‡πà ok ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà 404 ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô server error
                            if (response.status !== 404) {
                                throw new Error('Server error: ' + response.status);
                            }
                            // ‡∏ñ‡πâ‡∏≤ 404 ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£
                            return null;
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data && data.status === 'success') {
                            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô input fields
                            editWeight.value = data.weight;
                            editHeight.value = data.height;
                            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                            profileWeight.textContent = data.weight;
                            profileHeight.textContent = data.height;
                        }
                    })
                    .catch(error => {
                        console.error('Error loading user data:', error);
                        // ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á error ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ)
                    });
            }

            // 6. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• BMI ‡∏à‡∏≤‡∏Å API
            function loadProfileData() {
                // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏Å‡πà‡∏≠‡∏ô
                loadUserData();
                
                // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• BMI
                fetch(`http://localhost:8080/api/bmi/${username}`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.status === 'success') {
                            // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
                            const weight = parseFloat(data.weight) || parseFloat(editWeight.value) || 0;
                            const height = parseFloat(data.height) || parseFloat(editHeight.value) || 0;
                            
                            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                            updateProfileDisplay({
                                weight: weight,
                                height: height,
                                bmi: data.bmi,
                                calories: data.calories,
                                category: data.category,
                                categoryRange: data.categoryRange
                            });
                            
                            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï input fields
                            if (weight > 0) {
                                editWeight.value = weight;
                            }
                            if (height > 0) {
                                editHeight.value = height;
                            }
                        } else {
                            // ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°
                            const bmiBox = document.getElementById('profile-bmi-box');
                            bmiBox.innerHTML = `
                                <strong>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å:</strong> <span id="profile-weight">--</span> kg
                                <br>
                                <strong>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á:</strong> <span id="profile-height">--</span> cm
                                <br><br>
                                <strong>‡∏Ñ‡πà‡∏≤ BMI:</strong> <span id="profile-bmi">--.-</span>
                                <br>
                                <small>(‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô <span id="profile-calories">----</span> ‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà)</small>
                                <br><br>
                                <small style="color: #ff6b6b;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• BMI - ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà</small>
                            `;
                            bmiTableBody.innerHTML = '<tr><td>-</td><td>-</td></tr>';
                        }
                    })
                    .catch(error => {
                        console.error('Error loading BMI:', error);
                        // ‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÅ‡∏°‡πâ‡∏°‡∏µ error
                        const bmiBox = document.getElementById('profile-bmi-box');
                        bmiBox.innerHTML = `
                            <strong>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å:</strong> <span id="profile-weight">--</span> kg
                            <br>
                            <strong>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á:</strong> <span id="profile-height">--</span> cm
                            <br><br>
                            <strong>‡∏Ñ‡πà‡∏≤ BMI:</strong> <span id="profile-bmi">--.-</span>
                            <br>
                            <small>(‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô <span id="profile-calories">----</span> ‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà)</small>
                            <br><br>
                            <small style="color: #ff6b6b;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• BMI - ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà</small>
                        `;
                        bmiTableBody.innerHTML = '<tr><td>-</td><td>-</td></tr>';
                    });
            }

            // 7. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å, ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á, BMI, ‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ, ‡∏ï‡∏≤‡∏£‡∏≤‡∏á)
            function updateProfileDisplay(data) {
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á
                if (data.weight) {
                    profileWeight.textContent = data.weight;
                    editWeight.value = data.weight; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï input field ‡∏î‡πâ‡∏ß‡∏¢
                }
                if (data.height) {
                    profileHeight.textContent = data.height;
                    editHeight.value = data.height; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï input field ‡∏î‡πâ‡∏ß‡∏¢
                }
                
                // ‡πÅ‡∏™‡∏î‡∏á BMI ‡πÅ‡∏•‡∏∞‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà
                if (data.bmi) {
                    profileBmi.textContent = data.bmi;
                }
                if (data.calories) {
                    profileCalories.textContent = data.calories;
                }
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API)
                if (data.category && data.categoryRange) {
                    bmiTableBody.innerHTML = `<tr><td>${data.category}</td><td>${data.categoryRange}</td></tr>`;
                }
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ bmi-result-box ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                const bmiBox = document.getElementById('profile-bmi-box');
                if (bmiBox && data.bmi) {
                    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î HTML ‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                    bmiBox.innerHTML = `
                        <strong>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å:</strong> <span id="profile-weight">${data.weight || '--'}</span> kg
                        <br>
                        <strong>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á:</strong> <span id="profile-height">${data.height || '--'}</span> cm
                        <br><br>
                        <strong>‡∏Ñ‡πà‡∏≤ BMI:</strong> <span id="profile-bmi">${data.bmi || '--.-'}</span>
                        <br>
                        <small>(‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô <span id="profile-calories">${data.calories || '----'}</span> ‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà)</small>
                    `;
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï reference ‡πÉ‡∏´‡∏°‡πà
                    profileWeight.textContent = data.weight || '--';
                    profileHeight.textContent = data.height || '--';
                    profileBmi.textContent = data.bmi || '--.-';
                    profileCalories.textContent = data.calories || '----';
                }
            }

            // 8. ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
            logoutBtn.addEventListener('click', function() {
                localStorage.removeItem('currentUser');
                localStorage.removeItem('currentUserRole');
                localStorage.removeItem('cart'); 
            });
        });
    </script>
</body>
</html>